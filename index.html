<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExfilZone Hideout Tracker - 3rd Wipe</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00ff88;
            --primary-dim: #00cc6a;
            --secondary: #ff4400;
            --bg-dark: #0a0e14;
            --bg-medium: #151a24;
            --bg-light: #1f2937;
            --bg-card: #1a1f2e;
            --text-primary: #e4e8f0;
            --text-secondary: #8b95a8;
            --accent-blue: #00d4ff;
            --border: #2a3544;
            --locked: #4a5568;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            background-image:
                radial-gradient(circle at 20% 80%, rgba(0, 255, 136, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 68, 0, 0.03) 0%, transparent 50%);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            padding-bottom: 2rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--primary);
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: 4px;
            text-transform: uppercase;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-medium);
            border: 1px solid var(--border);
            border-left: 3px solid var(--primary);
            padding: 1rem;
            text-align: center;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.25rem;
        }

        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Filter Section */
        .filter-section {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            max-width: 400px;
            padding: 0.75rem 1rem;
            background: var(--bg-medium);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
            border-radius: 4px;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary);
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            background: var(--bg-medium);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 4px;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-btn.active {
            background: var(--primary);
            color: var(--bg-dark);
            border-color: var(--primary);
        }

        /* Category Section */
        .category-section {
            margin-bottom: 2rem;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: linear-gradient(90deg, var(--bg-light) 0%, transparent 100%);
            border-left: 4px solid var(--primary);
            margin-bottom: 1rem;
        }

        .category-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--primary);
        }

        .category-progress {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1rem;
        }

        /* Upgrade Card */
        .upgrade-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .upgrade-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 255, 136, 0.1);
        }

        .upgrade-card.completed {
            opacity: 0.6;
            border-color: var(--primary);
        }

        .upgrade-card.completed .card-header {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2) 0%, var(--bg-light) 100%);
        }

        .upgrade-card.completed::after {
            content: '✓';
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 28px;
            height: 28px;
            background: var(--primary);
            color: var(--bg-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
        }

        .card-header {
            background: var(--bg-light);
            padding: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .card-title-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .card-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .card-level {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 0.25rem 0.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent-blue) 100%);
            color: var(--bg-dark);
            border-radius: 3px;
        }

        .card-description {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .card-body {
            padding: 1rem;
        }

        .requirements-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.75rem;
        }

        .requirements-label::before {
            content: '';
            width: 16px;
            height: 16px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%238b95a8' viewBox='0 0 24 24'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        .card-price {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: var(--bg-dark);
            border-radius: 4px;
        }

        .price-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: #000;
        }

        .price-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .items-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .item-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: var(--bg-dark);
            border-radius: 4px;
        }

        .item-icon {
            width: 36px;
            height: 36px;
            object-fit: contain;
            border: 1px solid var(--border);
            border-radius: 3px;
            background: rgba(0, 0, 0, 0.5);
            padding: 2px;
        }

        .item-name {
            flex: 1;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .item-quantity {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            color: var(--primary);
            font-size: 0.9rem;
        }

        .no-items {
            font-style: italic;
            color: var(--text-secondary);
            font-size: 0.85rem;
            text-align: center;
            padding: 1rem;
        }

        .card-footer {
            padding: 0.75rem 1rem;
            background: var(--bg-dark);
            border-top: 1px solid var(--border);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .prereq-label {
            color: var(--locked);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Controls */
        .controls {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            background: var(--bg-medium);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 4px;
        }

        .btn.primary {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn.primary:hover {
            background: var(--primary);
            color: var(--bg-dark);
        }

        .btn.danger {
            border-color: var(--secondary);
            color: var(--secondary);
        }

        .btn.danger:hover {
            background: var(--secondary);
            color: var(--bg-dark);
        }

        .version-footer {
            text-align: center;
            padding: 2rem 0;
            margin-top: 2rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        /* Items Summary Section */
        .items-summary-section {
            margin-bottom: 2rem;
            background: var(--bg-medium);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .items-summary-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: var(--bg-light);
            cursor: pointer;
            transition: background 0.2s;
        }

        .items-summary-header:hover {
            background: var(--bg-card);
        }

        .items-summary-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--accent-blue);
        }

        .items-summary-title::before {
            content: '';
            width: 20px;
            height: 20px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%2300d4ff' viewBox='0 0 24 24'%3E%3Cpath d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14h-2v-4H6v-2h4V7h2v4h4v2h-4v4z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        .items-summary-toggle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            transition: transform 0.3s;
        }

        .items-summary-section.expanded .items-summary-toggle {
            transform: rotate(180deg);
        }

        .items-summary-content {
            display: none;
            padding: 1rem;
        }

        .items-summary-section.expanded .items-summary-content {
            display: block;
        }

        .items-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.5rem;
        }

        .summary-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: var(--bg-dark);
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        .summary-item-icon {
            width: 32px;
            height: 32px;
            object-fit: contain;
            border: 1px solid var(--border);
            border-radius: 3px;
            background: rgba(0, 0, 0, 0.5);
            padding: 2px;
        }

        .summary-item-name {
            flex: 1;
            font-size: 0.85rem;
            color: var(--text-primary);
        }

        .summary-item-qty {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            color: var(--primary);
            font-size: 0.9rem;
            min-width: 40px;
            text-align: right;
        }

        .items-summary-empty {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .items-summary-stats {
            display: flex;
            gap: 1.5rem;
            padding: 0.75rem 1rem;
            background: var(--bg-dark);
            border-top: 1px solid var(--border);
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .items-summary-stats span {
            color: var(--primary);
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.75rem; }
            .container { padding: 1rem; }
            .cards-grid { grid-template-columns: 1fr; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>HIDEOUT TRACKER</h1>
            <div class="subtitle">ExfilZone 3rd Wipe</div>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Progress</div>
                <div class="stat-value" id="progressPercent">0%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Completed</div>
                <div class="stat-value" id="completedCount">0/55</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Cost</div>
                <div class="stat-value" id="totalCost">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Spent</div>
                <div class="stat-value" id="moneySpent">$0</div>
            </div>
        </div>

        <div class="filter-section">
            <input type="text" class="search-box" id="searchBox" placeholder="Search upgrades or items...">
            <button class="filter-btn active" onclick="filterView('all')">All</button>
            <button class="filter-btn" onclick="filterView('incomplete')">Available</button>
            <button class="filter-btn" onclick="filterView('completed')">Maxed</button>
        </div>

        <div class="items-summary-section" id="itemsSummarySection">
            <div class="items-summary-header" onclick="toggleItemsSummary()">
                <div class="items-summary-title">Items Needed</div>
                <div class="items-summary-toggle">▼</div>
            </div>
            <div class="items-summary-content">
                <div class="items-summary-grid" id="itemsSummaryGrid"></div>
            </div>
            <div class="items-summary-stats" id="itemsSummaryStats"></div>
        </div>

        <div id="upgradesContainer"></div>

        <div class="controls">
            <button class="btn primary" onclick="toggleAll(true)">Mark All Complete</button>
            <button class="btn danger" onclick="toggleAll(false)">Mark All Incomplete</button>
            <button class="btn danger" onclick="resetProgress()">Reset Progress</button>
        </div>

        <div class="version-footer">
            v2.0.0 | Last Updated: January 2, 2025
        </div>
    </div>

    <script>
        // Item to image URL mapping
        const itemImages = {
            "Aspirin": "Images/Aspirin.png",
            "Antiquarian Book": "Images/B10.png",
            "Band-aids": "Images/B12.png",
            "Bottled glucose": "Images/B13.png",
            "CPU": "Images/B15.png",
            "Size D battery1": "Images/B18.png",
            "Spark Plug": "Images/B25.png",
            "Valve": "Images/B4.png",
            "Hard Drive": "Images/B9.png",
            "BeardOil": "Images/BeardOil.png",
            "Boxed Bolts": "Images/Boxed Bolts.png",
            "Boxed Nails": "Images/Boxed Nails.png",
            "Boxed Nuts": "Images/Boxed Nuts.png",
            "Ceramic adhesive": "Images/Ceramic adhesive.png",
            "Cleaner": "Images/Cleaner.png",
            "Climbing rope": "Images/Climbing rope.png",
            "Copper wire": "Images/Copper wire.png",
            "Oil can": "Images/D13.png",
            "CPU Fan": "Images/D15.png",
            "Size D battery2": "Images/D18.png",
            "Centrifuge": "Images/D22.png",
            "Tape": "Images/D9.png",
            "Defibrillator": "Images/Defibrillator.png",
            "Deodorant": "Images/Deodorant.png",
            "Disinfectant wipes": "Images/Disinfectant wipes.png",
            "Energy-saving lamp": "Images/Energy-saving lamp.png",
            "Marine battery": "Images/F16.png",
            "UV lamp": "Images/UV lamp.png",
            "Salt can": "Images/F4.png",
            "Floppydisk": "Images/F9.png",
            "Game console": "Images/Game console.png",
            "Gas pipe pliers": "Images/Gas pipe pliers.png",
            "Gun oil": "Images/Gun oil.png",
            "Gunpowder": "Images/Gunpowder.png",
            "Flash light": "Images/H15.png",
            "Civil Radio": "Images/H16.png",
            "Power Bank": "Images/H18.png",
            "Videotape": "Images/H9.png",
            "Hammer": "Images/Hammer.png",
            "Imaging module": "Images/Imaging module.png",
            "Instant glue": "Images/Instant glue.png",
            "Insulating Tape": "Images/Insulating Tape.png",
            "Iodine": "Images/Iodine.png",
            "Ion Battery": "Images/Ion Battery.png",
            "Lighter fluid": "Images/L12.png",
            "Radio": "Images/J16.png",
            "Rat Poison": "Images/J6.png",
            "Notebook": "Images/J9.png",
            "Gas can": "Images/L12.png",
            "Lighter": "Images/Lighter.png",
            "Vehicle battery": "Images/L18.png",
            "Portable medical kit": "Images/L21.png",
            "ElectricDrill": "Images/L25.png",
            "Spray can": "Images/L4.png",
            "Medical scissors": "Images/L7.png",
            "Large gas can": "Images/Large gas can.png",
            "Large Plier": "Images/Large Plier.png",
            "Magazine": "Images/Magazine.png",
            "Moldboard": "Images/Moldboard.png",
            "NewPhone": "Images/NewPhone.png",
            "OldPhone": "Images/N15.png",
            "Voltage transformer": "Images/N18.png",
            "Digital sensor": "Images/N27.png",
            "Asthma medicine": "Images/N4.png",
            "wastechip": "Images/n7.png",
            "Olive oil": "Images/Olive oil.png",
            "RAM": "Images/P15.png",
            "CD": "Images/P16.png",
            "Recorder": "Images/P28.png",
            "WD-40": "Images/WD-40.png",
            "Computer manual": "Images/P9.png",
            "Pesticide": "Images/Pesticide.png",
            "Pet Shampoo": "Images/Pet Shampoo.png",
            "Piezometer": "Images/Piezometer.png",
            "Rust cleaner": "Images/Rust cleaner.png",
            "Screwdriver": "Images/Screwdriver.png",
            "Small storage battery": "Images/Small storage battery.png",
            "Smokeless powder": "Images/Smokeless powder.png",
            "Socket": "Images/Socket.png",
            "Super Glue": "Images/Super Glue.png",
            "Tire Sealant": "Images/Tire Sealant.png",
            "Toilet Paper": "Images/Toilet Paper.png",
            "Windproof Matches": "Images/Windproof Matches.png",
            "Wire Cutter": "Images/Wire Cutter.png",
            "Wrench": "Images/Wrench.png"
        };

        const hideoutGroups = {
            "Workshop": ["Workshop", "Storage Room A", "Storage Room B", "Storage Room C"],
            "Living Quarters": ["Toilet", "Sofa", "TV Set", "Bookdesk"],
            "Tech & Utility": ["Generator", "Intel Center", "Bitcoin Mine", "Shooting Range"],
            "Kitchen Area": ["Kitchen Area", "Water Collector", "Refrigerator", "Microwave", "Coffee Maker"],
            "Medical": ["Medical Area", "Operating Bed", "Med Desk", "Plant Stand"],
            "Gunsmith": ["Gunsmith"]
        };

        const hideoutUpgrades = [
            // Workshop
            { name: "Workshop", level: 1, description: "Access to more storage spaces. Access to Armor Repair, Ammo loader and Keys hanger.", price: 50000, items: [], requirements: "" },
            { name: "Storage Room A", level: 1, description: "Access to storage room A", price: 80000, items: [["Boxed Nails", 3], ["Boxed Bolts", 3], ["Disinfectant wipes", 3], ["Large gas can", 3]], requirements: "Workshop 1" },
            { name: "Storage Room B", level: 1, description: "Access to storage room B", price: 400000, items: [["Large gas can", 6], ["Wrench", 6], ["Screwdriver", 6], ["Small storage battery", 6]], requirements: "Workshop 1" },
            { name: "Storage Room C", level: 1, description: "Access to storage room C", price: 400000, items: [["Gunpowder", 10], ["Smokeless powder", 10], ["Piezometer", 8], ["Imaging module", 6]], requirements: "Workshop 1" },
            // Living Quarters
            { name: "Toilet", level: 1, description: "Character experience gain +2%", price: 120000, items: [["Toilet Paper", 2], ["Hammer", 1], ["Pesticide", 1], ["Rust cleaner", 1]], requirements: "\"Homecoming\" Water Collector 1" },
            { name: "Toilet", level: 2, description: "Character experience gain +5%", price: 228000, items: [["Toilet Paper", 3], ["BeardOil", 3], ["Cleaner", 3], ["Pet Shampoo", 3]], requirements: "Toilet 1 Player Level 1" },
            { name: "Toilet", level: 3, description: "Character experience gain +10%", price: 350000, items: [["Toilet Paper", 8], ["Deodorant", 8], ["Pet Shampoo", 5], ["Piezometer", 5]], requirements: "Toilet 1 Player Level 1" },
            { name: "Sofa", level: 1, description: "Increase weight bearing capacity to 75", price: 50000, items: [["Climbing rope", 5], ["Tire Sealant", 3], ["Large Plier", 3], ["Hammer", 5]], requirements: "\"Homecoming\" Workshop 1" },
            { name: "Sofa", level: 2, description: "Increase weight bearing capacity to 80", price: 128000, items: [["Super Glue", 2], ["Magazine", 5], ["Insulating Tape", 8], ["Climbing rope", 5]], requirements: "Generator 2" },
            { name: "Sofa", level: 3, description: "Increase weight bearing capacity to 90", price: 500000, items: [["Game console", 2], ["Tire Sealant", 8], ["Deodorant", 6], ["Defibrillator", 1]], requirements: "Generator 3" },
            { name: "TV Set", level: 1, description: "Scavenger mode CD -10%", price: 50000, items: [["Size D battery1", 3], ["Size D battery2", 3], ["Ion Battery", 3], ["Civil Radio", 3]], requirements: "Player Level 5 Workshop 1" },
            { name: "TV Set", level: 2, description: "Scavenger mode CD -20%", price: 180000, items: [["Size D battery1", 5], ["Size D battery2", 5], ["Videotape", 1], ["ElectricDrill", 1]], requirements: "Generator 2 Player Level 1" },
            { name: "TV Set", level: 3, description: "Scavenger mode CD -30%", price: 420000, items: [["Size D battery1", 8], ["Size D battery2", 8], ["Videotape", 5], ["Rat Poison", 2]], requirements: "Generator 3 Player Level 1" },
            { name: "Bookdesk", level: 1, description: "Manual ammo reloading time -10%", price: 50000, items: [["Flash light", 5], ["Energy-saving lamp", 5], ["Socket", 3], ["Civil Radio", 2]], requirements: "\"Homecoming\" Workshop 1" },
            { name: "Bookdesk", level: 2, description: "Manual ammo reloading time -20%", price: 180000, items: [["Tape", 8], ["Antiquarian Book", 4], ["Recorder", 5], ["Power Bank", 4]], requirements: "Generator 2" },
            { name: "Bookdesk", level: 3, description: "Manual ammo reloading time -30%", price: 420000, items: [["Voltage transformer", 2], ["Computer manual", 8], ["Digital sensor", 2], ["Antiquarian Book", 6]], requirements: "Generator 3" },
            // Tech & Utility
            { name: "Generator", level: 1, description: "Increase Fuel capacity, reduce power consumption.", price: 0, items: [], requirements: "" },
            { name: "Generator", level: 2, description: "Increase Fuel capacity, reduce power consumption.", price: 100000, items: [["Lighter fluid", 6], ["Oil can", 8], ["Insulating Tape", 6], ["Spark Plug", 1]], requirements: "\"Handy Tool\" Generator 1" },
            { name: "Generator", level: 3, description: "Increase Fuel capacity, reduce power consumption.", price: 300000, items: [["Imaging module", 4], ["Spark Plug", 4], ["Voltage transformer", 2], ["Marine battery", 3]], requirements: "Generator 2" },
            { name: "Intel Center", level: 1, description: "Show item prices with M.I.C.A.", price: 100000, items: [["CD", 2], ["Size D battery2", 2], ["Size D battery1", 2], ["OldPhone", 1]], requirements: "" },
            { name: "Intel Center", level: 2, description: "Character experience gain +15%", price: 160000, items: [["CD", 4], ["Tape", 3], ["Notebook", 3], ["Radio", 2]], requirements: "Workshop 1" },
            { name: "Intel Center", level: 3, description: "Character experience gain +20%", price: 320000, items: [["CD", 6], ["Tape", 3], ["Videotape", 2], ["Power Bank", 3]], requirements: "Intel Center 2 Toilet 2" },
            { name: "Intel Center", level: 4, description: "Character experience gain +30%", price: 500000, items: [["CD", 10], ["Digital sensor", 4], ["Floppydisk", 3], ["Imaging module", 1]], requirements: "Intel Center 3 Toilet 3" },
            { name: "Bitcoin Mine", level: 1, description: "Generate periodic income using GPUs.", price: 100000, items: [["CPU", 1], ["Rust cleaner", 5], ["RAM", 6], ["Hard Drive", 5]], requirements: "\"Speaking of Finance\" Generator 2" },
            { name: "Bitcoin Mine", level: 2, description: "Unlock more slots; Increase money output.", price: 200000, items: [["CPU", 4], ["CPU Fan", 6], ["RAM", 4], ["Floppydisk", 4]], requirements: "Bitcoin Mine 1" },
            { name: "Bitcoin Mine", level: 3, description: "Unlock more slots; Increase money output.", price: 300000, items: [["CPU", 4], ["CPU Fan", 8], ["RAM", 6], ["Hard Drive", 6]], requirements: "Bitcoin Mine 2" },
            { name: "Bitcoin Mine", level: 4, description: "Unlock more slots; Increase money output.", price: 400000, items: [["CPU", 6], ["CPU Fan", 10], ["RAM", 8], ["Hard Drive", 6]], requirements: "Bitcoin Mine 3 Generator 3" },
            { name: "Shooting Range", level: 1, description: "Infinite ammo for firearms testing.", price: 50000, items: [["Gun oil", 2], ["Insulating Tape", 2], ["Ceramic adhesive", 1], ["Tire Sealant", 3]], requirements: "\"Lights On\"" },
            // Kitchen Area
            { name: "Kitchen Area", level: 1, description: "Unlocks Coffee Machine, Microwave, Refrigerator", price: 80000, items: [["Olive oil", 3], ["Salt can", 2], ["Gas can", 1], ["Large Plier", 1]], requirements: "Water Collector 1" },
            { name: "Water Collector", level: 1, description: "Access to a drink holder. Regenerate Hydration faster.", price: 10000, items: [["Valve", 2], ["Cleaner", 1], ["Salt can", 1], ["Large Plier", 1]], requirements: "\"The Source of Life\"" },
            { name: "Water Collector", level: 2, description: "Regenerate Hydration faster inside Hideout.", price: 50000, items: [["Valve", 5], ["Insulating Tape", 5], ["Boxed Nails", 6], ["Spray can", 2]], requirements: "" },
            { name: "Water Collector", level: 3, description: "Regenerate Hydration faster inside Hideout.", price: 100000, items: [["Valve", 10], ["Cleaner", 4], ["Vehicle battery", 3], ["Piezometer", 1]], requirements: "" },
            { name: "Refrigerator", level: 1, description: "Food and drinks Storage. Regenerate Energy faster.", price: 100000, items: [["Rust cleaner", 2], ["Salt can", 2], ["WD-40", 2], ["Wrench", 1]], requirements: "Kitchen Area 1" },
            { name: "Refrigerator", level: 2, description: "Regenerate Energy faster inside Hideout.", price: 160000, items: [["Olive oil", 2], ["Windproof Matches", 2], ["Wire Cutter", 4], ["Socket", 2]], requirements: "Generator 2" },
            { name: "Refrigerator", level: 3, description: "Regenerate Energy faster inside Hideout.", price: 240000, items: [["Olive oil", 4], ["Windproof Matches", 4], ["Large Plier", 8], ["Copper wire", 2]], requirements: "" },
            { name: "Microwave", level: 1, description: "In-Raid Energy Consumption -5%", price: 100000, items: [["Boxed Bolts", 6], ["Wire Cutter", 2], ["wastechip", 1], ["Oil can", 6]], requirements: "Kitchen Area 1" },
            { name: "Microwave", level: 2, description: "In-Raid Energy Consumption -10%", price: 200000, items: [["Large Plier", 8], ["Gas can", 8], ["wastechip", 5], ["Olive oil", 3]], requirements: "Generator 2" },
            { name: "Microwave", level: 3, description: "In-Raid Energy Consumption -15%", price: 300000, items: [["Copper wire", 6], ["Lighter", 6], ["WD-40", 12], ["Digital sensor", 2]], requirements: "Generator 3" },
            { name: "Coffee Maker", level: 1, description: "In-Raid Hydration Consumption -5%", price: 100000, items: [["Boxed Nuts", 3], ["Boxed Bolts", 2], ["Socket", 5], ["Civil Radio", 5]], requirements: "Kitchen Area 1" },
            { name: "Coffee Maker", level: 2, description: "In-Raid Hydration Consumption -10%", price: 200000, items: [["Boxed Nuts", 5], ["Cleaner", 3], ["Game console", 1], ["Salt can", 6]], requirements: "Generator 2" },
            { name: "Coffee Maker", level: 3, description: "In-Raid Hydration Consumption -15%", price: 300000, items: [["Boxed Nuts", 12], ["ElectricDrill", 3], ["Copper wire", 3], ["Lighter", 3]], requirements: "Generator 3" },
            // Medical
            { name: "Medical Area", level: 1, description: "Access to a syringe holder. Unlocks Med Desk, Plant Stand, Operating Bed", price: 100000, items: [["Disinfectant wipes", 2], ["Band-aids", 3], ["Bottled glucose", 1], ["Portable medical kit", 1]], requirements: "Water Collector 1" },
            { name: "Operating Bed", level: 1, description: "Free limb damage repair every hour. Faster health regen.", price: 60000, items: [["Bottled glucose", 1], ["Disinfectant wipes", 1], ["Energy-saving lamp", 1], ["Band-aids", 1]], requirements: "Medical Area 1 Toilet 1" },
            { name: "Operating Bed", level: 2, description: "Faster health regeneration in Hideout.", price: 120000, items: [["Bottled glucose", 5], ["Medical scissors", 3], ["Band-aids", 2], ["Centrifuge", 1]], requirements: "Generator 2" },
            { name: "Operating Bed", level: 3, description: "Faster health regeneration in Hideout.", price: 240000, items: [["Bottled glucose", 10], ["Medical scissors", 5], ["UV lamp", 3], ["Centrifuge", 1]], requirements: "Player Level 1 Water Collector 3" },
            { name: "Med Desk", level: 1, description: "Drink recovery +10%.", price: 80000, items: [["UV lamp", 1], ["Portable medical kit", 3], ["Band-aids", 2], ["Aspirin", 3]], requirements: "Water Collector 1 Medical Area 1" },
            { name: "Med Desk", level: 2, description: "Drink recovery +20%.", price: 220000, items: [["UV lamp", 3], ["Portable medical kit", 6], ["Asthma medicine", 4], ["Centrifuge", 2]], requirements: "Water Collector 1 Generator 2" },
            { name: "Med Desk", level: 3, description: "Drink recovery +30%.", price: 340000, items: [["UV lamp", 5], ["Portable medical kit", 9], ["Asthma medicine", 5], ["Centrifuge", 3]], requirements: "Water Collector 3" },
            { name: "Plant Stand", level: 1, description: "Food recovery +10%.", price: 80000, items: [["Moldboard", 1], ["Socket", 2], ["Energy-saving lamp", 5], ["Ion Battery", 1]], requirements: "Medical Area 1 Player Level 1 Toilet 1" },
            { name: "Plant Stand", level: 2, description: "Food recovery +20%.", price: 220000, items: [["Moldboard", 6], ["Aspirin", 2], ["Pesticide", 5], ["Gas pipe pliers", 2]], requirements: "Generator 2 Player Level 1" },
            { name: "Plant Stand", level: 3, description: "Food recovery +30%.", price: 340000, items: [["Moldboard", 12], ["Windproof Matches", 6], ["Iodine", 6], ["Gas pipe pliers", 3]], requirements: "Water Collector 3 Player Level 1" },
            // Gunsmith
            { name: "Gunsmith", level: 1, description: "Weapon parts storage capacity + 10kg", price: 10000, items: [["Boxed Bolts", 2], ["Gas can", 2], ["Rust cleaner", 2], ["Cleaner", 2]], requirements: "Workshop 1" },
            { name: "Gunsmith", level: 2, description: "Weapon parts storage capacity + 10kg", price: 80000, items: [["Valve", 2], ["Boxed Nails", 6], ["Ceramic adhesive", 8], ["Floppydisk", 2]], requirements: "Workshop 1" },
            { name: "Gunsmith", level: 3, description: "Weapon parts storage capacity + 10kg", price: 200000, items: [["Power Bank", 6], ["OldPhone", 10], ["Spark Plug", 6], ["Civil Radio", 4]], requirements: "Generator 2" },
            { name: "Gunsmith", level: 4, description: "Weapon parts storage capacity + 10kg", price: 400000, items: [["Super Glue", 10], ["NewPhone", 10], ["Instant glue", 8], ["ElectricDrill", 6]], requirements: "Generator 3" }
        ];

        const STORAGE_KEY = 'exfilzone-hideout-visual';
        let completedUpgrades = new Set();
        let currentFilter = 'all';

        function loadProgress() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                completedUpgrades = new Set(JSON.parse(saved));
            }
        }

        function saveProgress() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify([...completedUpgrades]));
        }

        function formatPrice(price) {
            if (price === 0) return 'FREE';
            return '$' + price.toLocaleString();
        }

        function getItemIcon(itemName) {
            const imagePath = itemImages[itemName];
            if (imagePath) {
                return `<img src="${imagePath}" class="item-icon" alt="${itemName}" title="${itemName}" onerror="this.style.display='none'">`;
            }
            return '';
        }

        function renderUpgrades() {
            const container = document.getElementById('upgradesContainer');
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            let html = '';

            Object.entries(hideoutGroups).forEach(([groupName, stationNames]) => {
                const groupUpgrades = hideoutUpgrades.filter(upgrade => stationNames.includes(upgrade.name));

                const filteredUpgrades = groupUpgrades.filter(upgrade => {
                    const upgradeId = `${upgrade.name}-${upgrade.level}`;
                    const isCompleted = completedUpgrades.has(upgradeId);

                    if (currentFilter === 'completed' && !isCompleted) return false;
                    if (currentFilter === 'incomplete' && isCompleted) return false;

                    const searchableText = `${groupName} ${upgrade.name} ${upgrade.description} ${upgrade.items.map(i => i[0]).join(' ')}`.toLowerCase();
                    if (searchTerm && !searchableText.includes(searchTerm)) return false;

                    return true;
                });

                if (filteredUpgrades.length === 0) return;

                const completedInGroup = groupUpgrades.filter(u => completedUpgrades.has(`${u.name}-${u.level}`)).length;

                html += `
                    <div class="category-section">
                        <div class="category-header">
                            <span class="category-title">${groupName}</span>
                            <span class="category-progress">${completedInGroup}/${groupUpgrades.length} Complete</span>
                        </div>
                        <div class="cards-grid">
                `;

                filteredUpgrades.forEach(upgrade => {
                    const upgradeId = `${upgrade.name}-${upgrade.level}`;
                    const isCompleted = completedUpgrades.has(upgradeId);

                    let itemsHtml = '';
                    if (upgrade.items.length === 0) {
                        itemsHtml = '<div class="no-items">No items required</div>';
                    } else {
                        itemsHtml = '<div class="items-list">';
                        upgrade.items.forEach(([item, quantity]) => {
                            itemsHtml += `
                                <div class="item-row">
                                    ${getItemIcon(item)}
                                    <span class="item-name">${item}</span>
                                    <span class="item-quantity">x${quantity}</span>
                                </div>
                            `;
                        });
                        itemsHtml += '</div>';
                    }

                    html += `
                        <div class="upgrade-card ${isCompleted ? 'completed' : ''}" onclick="toggleUpgrade('${upgradeId}')">
                            <div class="card-header">
                                <div class="card-title-row">
                                    <span class="card-name">${upgrade.name}</span>
                                    <span class="card-level">LV ${upgrade.level}</span>
                                </div>
                                <div class="card-description">${upgrade.description}</div>
                            </div>
                            <div class="card-body">
                                <div class="card-price">
                                    <span class="price-icon">$</span>
                                    <span class="price-value">${formatPrice(upgrade.price)}</span>
                                </div>
                                <div class="requirements-label">Requirements</div>
                                ${itemsHtml}
                            </div>
                            ${upgrade.requirements ? `<div class="card-footer"><span class="prereq-label">Requires:</span> ${upgrade.requirements}</div>` : ''}
                        </div>
                    `;
                });

                html += '</div></div>';
            });

            container.innerHTML = html;
            updateStats();
            renderItemsSummary();
        }

        function toggleUpgrade(upgradeId) {
            if (completedUpgrades.has(upgradeId)) {
                completedUpgrades.delete(upgradeId);
            } else {
                completedUpgrades.add(upgradeId);
            }
            saveProgress();
            renderUpgrades();
        }

        function toggleAll(completed) {
            if (completed) {
                hideoutUpgrades.forEach(upgrade => {
                    completedUpgrades.add(`${upgrade.name}-${upgrade.level}`);
                });
            } else {
                completedUpgrades.clear();
            }
            saveProgress();
            renderUpgrades();
        }

        function resetProgress() {
            if (confirm('Reset all progress?')) {
                completedUpgrades.clear();
                saveProgress();
                renderUpgrades();
            }
        }

        function updateStats() {
            const total = hideoutUpgrades.length;
            const completed = completedUpgrades.size;
            const percent = Math.round((completed / total) * 100);

            const totalCost = hideoutUpgrades.reduce((sum, u) => sum + u.price, 0);
            const moneySpent = hideoutUpgrades
                .filter(u => completedUpgrades.has(`${u.name}-${u.level}`))
                .reduce((sum, u) => sum + u.price, 0);

            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('completedCount').textContent = `${completed}/${total}`;
            document.getElementById('totalCost').textContent = formatPrice(totalCost);
            document.getElementById('moneySpent').textContent = formatPrice(moneySpent);
        }

        function filterView(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderUpgrades();
        }

        function toggleItemsSummary() {
            const section = document.getElementById('itemsSummarySection');
            section.classList.toggle('expanded');
        }

        function calculateItemTotals() {
            const itemTotals = {};

            hideoutUpgrades.forEach(upgrade => {
                const upgradeId = `${upgrade.name}-${upgrade.level}`;
                if (!completedUpgrades.has(upgradeId)) {
                    upgrade.items.forEach(([itemName, quantity]) => {
                        if (!itemTotals[itemName]) {
                            itemTotals[itemName] = 0;
                        }
                        itemTotals[itemName] += quantity;
                    });
                }
            });

            return itemTotals;
        }

        function renderItemsSummary() {
            const itemTotals = calculateItemTotals();
            const grid = document.getElementById('itemsSummaryGrid');
            const stats = document.getElementById('itemsSummaryStats');

            const sortedItems = Object.entries(itemTotals)
                .sort((a, b) => b[1] - a[1]);

            if (sortedItems.length === 0) {
                grid.innerHTML = '<div class="items-summary-empty">All upgrades completed! No items needed.</div>';
                stats.innerHTML = '';
                return;
            }

            let html = '';
            sortedItems.forEach(([itemName, quantity]) => {
                const imagePath = itemImages[itemName] || '';
                const iconHtml = imagePath
                    ? `<img src="${imagePath}" class="summary-item-icon" alt="${itemName}" title="${itemName}" onerror="this.style.display='none'">`
                    : '';

                html += `
                    <div class="summary-item">
                        ${iconHtml}
                        <span class="summary-item-name">${itemName}</span>
                        <span class="summary-item-qty">x${quantity}</span>
                    </div>
                `;
            });

            grid.innerHTML = html;

            const uniqueItems = sortedItems.length;
            const totalItems = sortedItems.reduce((sum, [, qty]) => sum + qty, 0);
            stats.innerHTML = `Unique items: <span>${uniqueItems}</span> | Total items: <span>${totalItems}</span>`;
        }

        document.getElementById('searchBox').addEventListener('input', renderUpgrades);

        loadProgress();
        renderUpgrades();
        renderItemsSummary();
    </script>
</body>
</html>
